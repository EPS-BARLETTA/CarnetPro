<!doctype html><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Reset CarnetPro</title>
<style>
body{font-family:system-ui;background:#0b1324;color:#fff;display:grid;place-items:center;min-height:100vh;margin:0}
.card{max-width:720px;padding:24px;border-radius:16px;background:#111827;border:1px solid #374151}
h1{margin:0 0 12px 0}
.btn{padding:12px 16px;border-radius:12px;border:0;background:#2563eb;color:#fff;font-weight:800;cursor:pointer}
pre{background:#000;padding:12px;border-radius:8px;overflow:auto;color:#0f0}
a.btn{display:inline-block;text-decoration:none}
</style>
<div class="card">
  <h1>Nettoyage CarnetPro</h1>
  <p>Supprime <strong>caches</strong>, <strong>Service Workers</strong> et <strong>localStorage</strong> de ce site.</p>
  <button class="btn" id="go">Lancer le nettoyage</button>
  <p id="res"></p>
  <pre id="log"></pre>
  <p><a class="btn" href="seance.html">→ Aller à la page Séance</a></p>
</div>
<script>
const log = (m)=>{ const el=document.getElementById('log'); el.textContent += m + "\\n"; }
document.getElementById('go').onclick = async ()=>{
  const res = document.getElementById('res'); res.textContent = 'Nettoyage en cours...';
  try{
    if('serviceWorker' in navigator){
      const regs = await navigator.serviceWorker.getRegistrations();
      for(const r of regs){ log('Unregister SW: '+(r.scope||'?')); await r.unregister(); }
    }
    if('caches' in window){
      const names = await caches.keys();
      for(const n of names){ log('Delete cache: '+n); await caches.delete(n); }
    }
    localStorage.clear(); sessionStorage.clear();
    res.textContent = '✅ Terminé. Ouvre maintenant seance.html';
  }catch(e){
    res.textContent = '❌ Erreur: '+(e?.message||e);
  }
};
</script>
